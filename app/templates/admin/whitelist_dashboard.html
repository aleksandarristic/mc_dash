{% extends "base.html" %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb mb-0">
    <li class="breadcrumb-item"><a href="/">Poƒçetna</a></li>
    <li class="breadcrumb-item"><a href="{{ url_for('admin_dashboard') }}">Administracija</a></li>
    <li class="breadcrumb-item active" aria-current="page">Whitelist Dashboard</li>
  </ol>
</nav>
{% endblock %}

{% block content %}
<h2>Whitelist</h2>
<ul id="whitelist">
    {% for line in whitelist.splitlines() %}
    <li>{{ line }} <button onclick="removeFrom('whitelist', '{{ line }}')">Remove</button></li>
    {% endfor %}
</ul>
<input id="whitelist-name" placeholder="Player name" />
<button onclick="addTo('whitelist')">Add to Whitelist</button>

<script>
async function addTo(listType) {
    const input = document.getElementById(`${listType}-name`);
    const player = input.value.trim();
    if (!player) return;
    const res = await fetch(`/admin/${listType}/add`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ player })
    });
    const data = await res.json();
    alert(data.result);
    location.reload();
}

async function removeFrom(listType, player) {
    const res = await fetch(`/admin/${listType}/remove`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ player })
    });
    const data = await res.json();
    alert(data.result);
    location.reload();
}
</script>
{% endblock %}
